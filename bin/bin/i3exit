#!/bin/sh
lock() {
    if xrandr | grep '*' | grep '^   1366x768' >/dev/null
       then if xrandr | grep '*' | grep '^   1920x1080' >/dev/null
          then i3lock -d -i  $HOME/Pictures/noise-texture.png -t
       else i3lock -d -i $HOME/Pictures/262039-small.png
       fi
    else i3lock -d -i $HOME/Pictures/262039.png
    fi 
}

lock_without_sleep() {
    if xrandr | grep '*' | grep '^   1366x768' >/dev/null
       then if xrandr | grep '*' | grep '^   1920x1080' >/dev/null
          then i3lock -i  $HOME/Pictures/noise-texture.png -t
       else i3lock -i $HOME/Pictures/262039-small.png
       fi
    else i3lock -i $HOME/Pictures/262039.png
    fi
}


blur() {
   file1=$(mktemp --tmpdir i3lock-wrapper-XXXXXXXXXX.png)
   file2=$(mktemp --tmpdir i3lock-wrapper-XXXXXXXXXX.png)
   scrot -d0 "$file1"
   convert "$file1" -blur 0x9 "$file2"
   i3lock -i "$file2" 
   trap "rm '$file1' '$file2'" EXIT
}

blur_with_sleep() {
   file1=$(mktemp --tmpdir i3lock-wrapper-XXXXXXXXXX.png)
   file2=$(mktemp --tmpdir i3lock-wrapper-XXXXXXXXXX.png)
   scrot -d0 "$file1"
   convert "$file1" -blur 0x9 "$file2"
   i3lock -di "$file2" 
   trap "rm '$file1' '$file2'" EXIT

}

freeze() {
   file1=$(mktemp --tmpdir i3lock-wrapper-XXXXXXXXXX.png)
   scrot -d0 "$file1"
   i3lock -i "$file1"
   trap "rm '$file1'" EXIT
}

#262039.png
case "$1" in
    lock)
        lock
        ;;
    lock_without_sleep)
        lock_without_sleep
        ;;
    blur)
        blur
        ;;
    blur_with_sleep)
        blur_with_sleep
        ;;
    freeze)
        freeze
        ;;
    logout)
        i3-msg exit
        ;;
    suspend)
        lock && systemctl suspend
        ;;
    hibernate)
        lock && systemctl hibernate
        ;;
    reboot)
        systemctl reboot
        ;;
    shutdown)
        systemctl poweroff
        ;;
    *)
        echo "Usage: $0 {lock|lock_without_sleep|blur|blur_with_sleep|freeze|logout|suspend|hibernate|reboot|shutdown}"
        exit 2
esac

exit 0

